<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Entradas Movom - Teste</title>

<script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js"></script>

<style>
body { font-family: Arial; padding: 20px; }
select, input, button { padding: 8px; margin: 5px 0; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
</style>
</head>
<body>

<h2>Entradas Movom - Teste</h2>

<label>Mês:</label>
<select id="mesSelect"></select>
<br><br>

<input type="text" id="nome" placeholder="Nome do aluno">
<input type="text" id="cpf" placeholder="CPF/CNPJ">
<input type="number" id="valor" placeholder="Valor">
<br>
<button onclick="adicionarPagamento()">Adicionar</button>

<h3>Histórico</h3>
<table>
<thead>
<tr><th>Nome</th><th>CPF/CNPJ</th><th>Valor</th><th>Data</th></tr>
</thead>
<tbody id="tabelaBody"></tbody>
</table>

<script>
// Configuração do Firebase
const firebaseConfig = {
  apiKey: "AIzaSyAiaiPHw98hV9yPt1M8mN-2ZC62TVUG6Lk",
  authDomain: "movomentradas.firebaseapp.com",
  databaseURL: "https://movomentradas-default-rtdb.firebaseio.com",
  projectId: "movomentradas",
  storageBucket: "movomentradas.firebasestorage.app",
  messagingSenderId: "5423221990",
  appId: "1:5423221990:web:29a72ef5e6cad1e3afff27"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let mesAtual;

// Preencher select de meses
document.addEventListener("DOMContentLoaded", () => {
  const meses = ["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];
  const mesSelect = document.getElementById("mesSelect");

  meses.forEach(m => {
    const opt = document.createElement("option");
    opt.value = m;
    opt.textContent = m;
    mesSelect.appendChild(opt);
  });

  mesAtual = meses[new Date().getMonth()];
  mesSelect.value = mesAtual;

  mesSelect.addEventListener("change", () => {
    mesAtual = mesSelect.value;
    carregarHistorico();
  });

  carregarHistorico();
});

function getDbRef() { return db.ref('pagamentos/' + mesAtual); }

function adicionarPagamento() {
  const nome = document.getElementById("nome").value.trim();
  const cpf = document.getElementById("cpf").value.trim();
  const valor = parseFloat(document.getElementById("valor").value);
  const data = new Date().toLocaleString("pt-BR");

  if(!nome || !cpf || !valor) { alert("Preencha todos os campos!"); return; }

  getDbRef().push({nome, cpf, valor, data});

  document.getElementById("nome").value = "";
  document.getElementById("cpf").value = "";
  document.getElementById("valor").value = "";
}

function carregarHistorico() {
  getDbRef().on('value', snapshot => {
    const tabelaBody = document.getElementById("tabelaBody");
    tabelaBody.innerHTML = "";
    const data = snapshot.val();

    if(data){
      Object.values(data).forEach(p => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${p.nome}</td><td>${p.cpf}</td><td>${p.valor}</td><td>${p.data}</td>`;
        tabelaBody.appendChild(tr);
      });
    }
  });
}
</script>

</body>
</html>




